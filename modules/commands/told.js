module.exports.config = {
	name: "told",
	version: "1.0.1",
	hasPermssion: 0,
	credits: "aizen code",
	description: "told [mentioned]",
	commandCategory: "edit-image",
	usages: "rank",
	cooldowns: 5,
	dependencies: {
	  "fs-extra": "",
	  "axios": "",
	  "canvas" :"",
	  "jimp": "",
	  "node-superfetch": ""
	}
};

module.exports.circle = async (image) => {
	  const jimp = global.nodemodule['jimp'];
  	image = await jimp.read(image);
  	image.circle();
  	return await image.getBufferAsync("image/png");
};

module.exports.run = async ({ event, api, args, Users }) => {
try {
  const Canvas = global.nodemodule['canvas'];
  const request = global.nodemodule["node-superfetch"];
  const jimp = global.nodemodule["jimp"];
  const fs = global.nodemodule["fs-extra"];
  var path_toilet = __dirname+'/cache/toilet.png'; 
  var id = Object.keys(event.mentions)[0] || event.senderID;
  const canvas = Canvas.createCanvas(800, 900);
	const ctx = canvas.getContext('2d');
	const background = await Canvas.loadImage('data:image/jpeg;base64,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');
  
	var avatar = await request.get(`https://graph.facebook.com/${id}/picture?width=512&height=512&access_token=6628568379%7Cc1e620fa708a1d5696fb991c1bde5662`);
	avatar = await this.circle(avatar.body);
	ctx.drawImage(background, 0, 0, canvas.width, canvas.height);
	ctx.drawImage(await Canvas.loadImage(avatar), 300, 500, 300, 300);
	const imageBuffer = canvas.toBuffer();
	fs.writeFileSync(path_toilet,imageBuffer);
	 api.sendMessage({attachment: fs.createReadStream(path_toilet, {'highWaterMark': 128 * 1024}), body: "Ang baho mo!"}, event.threadID, () => fs.unlinkSync(path_toilet), event.messageID);
}
catch(e) {api.sendMessage(e.stack, event.threadID )}
    }